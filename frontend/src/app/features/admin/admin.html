<section class="admin-page">

  <div class="admin-toolbar">
    <button class="refresh-btn" (click)="refresh()">Refresh</button>
  </div>


  <h2>Pending Approvals</h2>

  <div class="table">

    <div class="row header">
      <div>Email</div>
      <div>Company</div>
      <div>Role</div>
      <div>Status</div>
      <div class="actions-col">Actions</div>
    </div>

    @for (user of pendingUsers(); track user.id) {
    <div class="row">
      <div>{{ user.email }}</div>
      <div>{{ user.companyName ?? '—' }}</div>
      <div class="role">{{ roleLabel(user.role) }}</div>
      <div class="status">{{ statusLabel(user.status) }}</div>

      <div class="actions">
        <button (click)="approve(user.id)">Approve</button>
        <button class="danger" (click)="reject(user.id)">Reject</button>
      </div>
    </div>
    } @empty {
    <p class="empty">No pending users</p>
    }

  </div>



  <h2>All Users</h2>

  <div class="table">

    <div class="row header">
      <div>Email</div>
      <div>Company</div>
      <div>Role</div>
      <div>Status</div>
      <div class="actions-col">Actions</div>
    </div>

    @for (user of users(); track user.id) {
    <div class="row">

      <div>{{ user.email }}</div>

      <div>{{ user.companyName ?? '—' }}</div>

      <div class="role">
        {{ roleLabel(user.role) }}
      </div>

      <div class="status">
        {{ statusLabel(user.status) }}
      </div>

      <div class="actions">

        @if (!isCurrentUser(user.id) && user.role !== 0 && user.status === 1) {
        <button (click)="promote(user.id)">Promote</button>
        }

        @if (user.status === 3) {
        <button (click)="unlock(user.id)">Unlock</button>
        }

        @if (!isCurrentUser(user.id)) {
        <button class="danger" (click)="delete(user.id)">Delete</button>
        }

      </div>

    </div>
    } @empty {
    <p class="empty">No users found</p>
    }

  </div>

</section>